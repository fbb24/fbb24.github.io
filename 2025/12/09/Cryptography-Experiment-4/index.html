<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Cryptography-Experiment-4 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="现代密码学实验四：RSA 加密体制破译   课程名称 现代密码学 实验人 冯汝鑫    题目 实验四：RSA 综合攻击与大礼包破译 学号 23009200482   实验摘要本实验基于“首届（2016）全国高校密码数学挑战赛”赛题三（RSA 大礼包），模拟了针对 RSA 加密体制的综合破译过程。实验提供了 21 组截获的 RSA 参数 $(N, e, c)$。通过对参数特性的分析，识别出了多种安全">
<meta property="og:type" content="article">
<meta property="og:title" content="Cryptography-Experiment-4">
<meta property="og:url" content="http://example.com/2025/12/09/Cryptography-Experiment-4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="现代密码学实验四：RSA 加密体制破译   课程名称 现代密码学 实验人 冯汝鑫    题目 实验四：RSA 综合攻击与大礼包破译 学号 23009200482   实验摘要本实验基于“首届（2016）全国高校密码数学挑战赛”赛题三（RSA 大礼包），模拟了针对 RSA 加密体制的综合破译过程。实验提供了 21 组截获的 RSA 参数 $(N, e, c)$。通过对参数特性的分析，识别出了多种安全">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-12-09T12:57:50.000Z">
<meta property="article:modified_time" content="2025-12-09T19:55:47.236Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.1.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Cryptography-Experiment-4" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2025/12/09/Cryptography-Experiment-4/" class="article-date">
  <time class="dt-published" datetime="2025-12-09T12:57:50.000Z" itemprop="datePublished">2025-12-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Cryptography-Experiment-4
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="现代密码学实验四：RSA-加密体制破译"><a href="#现代密码学实验四：RSA-加密体制破译" class="headerlink" title="现代密码学实验四：RSA 加密体制破译"></a>现代密码学实验四：RSA 加密体制破译</h1><table>
<thead>
<tr>
<th align="left">课程名称</th>
<th align="left">现代密码学</th>
<th align="left">实验人</th>
<th align="left">冯汝鑫</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><strong>题目</strong></td>
<td align="left"><strong>实验四：RSA 综合攻击与大礼包破译</strong></td>
<td align="left"><strong>学号</strong></td>
<td align="left">23009200482</td>
</tr>
</tbody></table>
<h2 id="实验摘要"><a href="#实验摘要" class="headerlink" title="实验摘要"></a>实验摘要</h2><p>本实验基于“首届（2016）全国高校密码数学挑战赛”赛题三（RSA 大礼包），模拟了针对 RSA 加密体制的综合破译过程。<br>实验提供了 21 组截获的 RSA 参数 $(N, e, c)$。通过对参数特性的分析，识别出了多种安全漏洞，包括共模攻击、广播攻击、模数因子共享、费马分解、Pollard’s p-1 分解以及 Coppersmith 小指数攻击。<br>实验编写了综合 Python 脚本（结合 SageMath），成功还原了所有分片的明文，并根据上下文拼接出了完整的隐藏消息，验证了 RSA 在参数选取不当或使用模式错误时的脆弱性。</p>
<hr>
<h2 id="一、-题目描述与数据分析"><a href="#一、-题目描述与数据分析" class="headerlink" title="一、 题目描述与数据分析"></a>一、 题目描述与数据分析</h2><h3 id="1-1-背景"><a href="#1-1-背景" class="headerlink" title="1.1 背景"></a>1.1 背景</h3><p>题目模拟了一个 RSA 通信场景，拦截者捕获了 21 个数据帧（Frame 0 至 Frame 20）。每个数据帧包含：</p>
<ul>
<li>1024-bit 模数 $N$</li>
<li>1024-bit 加密指数 $e$</li>
<li>1024-bit 密文 $c &#x3D; m^e \pmod N$</li>
</ul>
<h3 id="1-2-明文结构推断"><a href="#1-2-明文结构推断" class="headerlink" title="1.2 明文结构推断"></a>1.2 明文结构推断</h3><p>在破解过程中，通过部分解密的明文发现，原始消息被分片加密，且每个分片 $m$ 填充为 512 比特后进行加密。填充结构如下：<br><code>[ 标志位 (64bit) ] || [ 序号 (32bit) ] || [ 填充 0 ] || [ 明文分片 (64bit) ]</code><br>其中固定标志位为 <code>0x9876543210abcdef</code>。</p>
<hr>
<h2 id="二、-攻击原理与过程"><a href="#二、-攻击原理与过程" class="headerlink" title="二、 攻击原理与过程"></a>二、 攻击原理与过程</h2><p>通过分析 21 组数据，发现存在以下几类典型的 RSA 漏洞：</p>
<h3 id="2-1-协议与使用模式漏洞"><a href="#2-1-协议与使用模式漏洞" class="headerlink" title="2.1 协议与使用模式漏洞"></a>2.1 协议与使用模式漏洞</h3><h4 id="2-1-1-共模攻击-Common-Modulus-Attack"><a href="#2-1-1-共模攻击-Common-Modulus-Attack" class="headerlink" title="2.1.1 共模攻击 (Common Modulus Attack)"></a>2.1.1 共模攻击 (Common Modulus Attack)</h4><p><strong>原理</strong>：当同一条消息 $m$（或具有某种线性关系的消息）用相同的模数 $N$ 但不同的公钥指数 $e_1, e_2$ 加密时，若 $\gcd(e_1, e_2)&#x3D;1$，攻击者可求得 $s_1, s_2$ 使得 $s_1e_1 + s_2e_2 &#x3D; 1$。<br>$$c_1^{s_1} \cdot c_2^{s_2} \equiv m^{s_1e_1 + s_2e_2} \equiv m^1 \equiv m \pmod N$$<br><strong>应用</strong>：</p>
<ul>
<li><strong>Frame 0</strong> 和 <strong>Frame 4</strong> 的模数 $N$ 完全相同。</li>
<li>$e_0$ 很大，$e_4$ 很大，但互素。</li>
<li><strong>结果</strong>：成功解出明文，序号为 0。</li>
</ul>
<h4 id="2-1-2-广播攻击-Small-Exponent-Broadcast-Attack"><a href="#2-1-2-广播攻击-Small-Exponent-Broadcast-Attack" class="headerlink" title="2.1.2 广播攻击 (Small Exponent Broadcast Attack)"></a>2.1.2 广播攻击 (Small Exponent Broadcast Attack)</h4><p><strong>原理</strong>：当同一条明文 $m$ 被加密并发送给 $k$ 个用户，若加密指数 $e$ 较小且 $k \ge e$，可以使用中国剩余定理 (CRT) 求解。<br>$$\begin{cases} c_1 \equiv m^e \pmod{N_1} \ \vdots \ c_k \equiv m^e \pmod{N_k} \end{cases} \implies C \equiv m^e \pmod{N_1 \dots N_k}$$<br>求出 $C$ 后，直接开 $e$ 次方即可得到 $m$。<br><strong>应用</strong>：</p>
<ul>
<li><strong>Frame 3, 8, 12, 16, 20</strong> 均使用了 $e&#x3D;5$。</li>
<li>收集这 5 组密文进行 CRT求解。</li>
<li><strong>结果</strong>：成功解出明文，序号为 1。</li>
</ul>
<h4 id="2-1-3-Coppersmith-立体声消息攻击-Stereotyped-Message-Attack"><a href="#2-1-3-Coppersmith-立体声消息攻击-Stereotyped-Message-Attack" class="headerlink" title="2.1.3 Coppersmith 立体声消息攻击 (Stereotyped Message Attack)"></a>2.1.3 Coppersmith 立体声消息攻击 (Stereotyped Message Attack)</h4><p><strong>原理</strong>：当 $e$ 很小（如 $e&#x3D;3$），且攻击者已知明文的大部分位（如高位固定格式），未知部分较短时，可以构造多项式 $f(x) &#x3D; (K + x)^e - c \pmod N$，寻找其在模 $N$ 下的小根。<br><strong>应用</strong>：</p>
<ul>
<li><strong>Frame 7, 11, 15</strong> 使用了 $e&#x3D;3$。</li>
<li>已知明文高位包含标志位和可能的序号（0-20），未知部分仅为 64bit 的 ASCII 字符。</li>
<li>使用 SageMath 的 <code>small_roots</code> 方法求解。</li>
<li><strong>结果</strong>：成功解出序号为 2, 3, 4 的分片。</li>
</ul>
<h3 id="2-2-弱密钥漏洞-因子分解"><a href="#2-2-弱密钥漏洞-因子分解" class="headerlink" title="2.2 弱密钥漏洞 (因子分解)"></a>2.2 弱密钥漏洞 (因子分解)</h3><h4 id="2-2-1-模数因子共享-Common-Factor-Attack"><a href="#2-2-1-模数因子共享-Common-Factor-Attack" class="headerlink" title="2.2.1 模数因子共享 (Common Factor Attack)"></a>2.2.1 模数因子共享 (Common Factor Attack)</h4><p><strong>原理</strong>：若两个模数 $N_1, N_2$ 共享一个素因子 $p$，则可以通过 $\gcd(N_1, N_2) &#x3D; p$ 快速分解 $N$。<br><strong>应用</strong>：</p>
<ul>
<li><strong>Frame 1</strong> 和 <strong>Frame 18</strong> 的模数具有非平凡公约数。</li>
<li><strong>结果</strong>：分解后求逆元解密，得到序号 11 和 10 的分片。</li>
</ul>
<h4 id="2-2-2-费马分解-Fermat-Factorization"><a href="#2-2-2-费马分解-Fermat-Factorization" class="headerlink" title="2.2.2 费马分解 (Fermat Factorization)"></a>2.2.2 费马分解 (Fermat Factorization)</h4><p><strong>原理</strong>：当素因子 $p, q$ 非常接近时，$\Delta &#x3D; (\frac{p+q}{2})^2 - N$ 是一个完全平方数。<br><strong>应用</strong>：</p>
<ul>
<li><strong>Frame 10</strong> 的 $N$ 可以通过费马分解法在极短时间内分解。</li>
<li><strong>结果</strong>：成功解出序号 8 的分片。</li>
</ul>
<h4 id="2-2-3-Pollard’s-p-1-分解"><a href="#2-2-3-Pollard’s-p-1-分解" class="headerlink" title="2.2.3 Pollard’s p-1 分解"></a>2.2.3 Pollard’s p-1 分解</h4><p><strong>原理</strong>：当 $p-1$ 是光滑数（即其所有质因子都很小）时，可以通过计算 $a^{B!} \pmod N$ 来求出 $p$。<br><strong>应用</strong>：</p>
<ul>
<li><strong>Frame 2, 6, 19</strong> 的模数因子具有此特性。</li>
<li><strong>结果</strong>：成功分解并解密，得到序号 6, 7, 5 的分片。</li>
</ul>
<h3 id="2-3-维纳攻击-Wiener’s-Attack"><a href="#2-3-维纳攻击-Wiener’s-Attack" class="headerlink" title="2.3 维纳攻击 (Wiener’s Attack)"></a>2.3 维纳攻击 (Wiener’s Attack)</h3><p><strong>原理</strong>：当 $e$ 非常大且 $d &lt; \frac{1}{3}N^{1&#x2F;4}$ 时，可以通过连分数展开逼近 $d$。<br><strong>应用</strong>：<strong>Frame 4</strong> 的 $e$ 巨大，符合特征。但由于 Frame 4 已通过共模攻击解决，此方法作为验证。</p>
<h3 id="2-4-上下文推断"><a href="#2-4-上下文推断" class="headerlink" title="2.4 上下文推断"></a>2.4 上下文推断</h3><p>对于剩余无法通过数学方法在合理时间内破解的帧 (<strong>Frame 5, 9, 13, 14, 17</strong>)，根据已解密出的明文片段，结合英语语法和名人名言库，推测出缺失的单词，并通过加密验证（即猜测 $m$ 计算 $m^e \pmod N$ 是否等于 $c$）来确认。</p>
<hr>
<h2 id="三、-实验结果"><a href="#三、-实验结果" class="headerlink" title="三、 实验结果"></a>三、 实验结果</h2><h3 id="3-1-破解过程日志"><a href="#3-1-破解过程日志" class="headerlink" title="3.1 破解过程日志"></a>3.1 破解过程日志</h3><p>通过运行编写的 Python 脚本，得到如下破解序列：</p>
<ol>
<li><strong>Common Modulus</strong>: Frame [0, 4] -&gt; Seq 0, Text “My secre”</li>
<li><strong>Broadcast (e&#x3D;5)</strong>: Frame [3, 8, 12, 16, 20] -&gt; Seq 1, Text “t is a f”</li>
<li><strong>GCD</strong>: Frame 1 &amp; 18 -&gt; Seq 11 (“. Imagin”) &#x2F; Seq 10 (“m A to B”)</li>
<li><strong>Fermat</strong>: Frame 10 -&gt; Seq 8 (“will get”)</li>
<li><strong>Pollard p-1</strong>: Frame 2 (“That is “), Frame 6 (“”Logic “), Frame 19 (“instein.”)</li>
<li><strong>Coppersmith (e&#x3D;3)</strong>: Frame 7 (“amous sa”), Frame 11 (“ying of “), Frame 15 (“Albert E”)</li>
<li><strong>Context Guess</strong>:<ul>
<li>Seq 12: “ation wi” (Frame 5)</li>
<li>Seq 13: “ll take “ (Frame 9)</li>
<li>Seq 14: “you ever” (Frame 13)</li>
<li>Seq 9: “ you fro” (Frame 14)</li>
<li>Seq 15: “ywhere.”” (Frame 17)</li>
</ul>
</li>
</ol>
<h3 id="3-2-最终明文"><a href="#3-2-最终明文" class="headerlink" title="3.2 最终明文"></a>3.2 最终明文</h3><p>将所有分片按序号排序拼接，得到完整消息：</p>
<blockquote>
<p><strong>My secret is a famous saying of Albert Einstein. That is “Logic will get you from A to B. Imagination will take you everywhere.”</strong></p>
</blockquote>
<hr>
<h2 id="四、-源代码"><a href="#四、-源代码" class="headerlink" title="四、 源代码"></a>四、 源代码</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> dataclasses <span class="keyword">import</span> dataclass</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ProcessPoolExecutor</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> combinations</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> mpz, iroot, gcd, invert, powmod, is_prime</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意：Coppersmith 攻击需要 SageMath 环境支持</span></span><br><span class="line"><span class="comment"># 如果在纯 Python 环境运行，请确保已安装 sage 库或注释掉相关部分</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> PolynomialRing, Zmod</span><br><span class="line"><span class="keyword">except</span> ImportError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Warning: SageMath not found. Coppersmith attack will fail.&quot;</span>)</span><br><span class="line"></span><br><span class="line">DATA_DIR = <span class="string">&#x27;附件3-2（发布截获数据）&#x27;</span></span><br><span class="line">FLAG_HEX = <span class="string">&quot;9876543210abcdef&quot;</span></span><br><span class="line">FLAG_VAL = <span class="built_in">int</span>(FLAG_HEX, <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@dataclass</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Frame</span>:</span><br><span class="line">    idx: <span class="built_in">int</span></span><br><span class="line">    n: mpz</span><br><span class="line">    e: mpz</span><br><span class="line">    c: mpz</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load_frames</span>() -&gt; <span class="built_in">list</span>[Frame]:</span><br><span class="line">    frames = []</span><br><span class="line">    <span class="comment"># 假设数据文件在当前目录下或指定目录</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">21</span>):</span><br><span class="line">        <span class="comment"># 模拟读取逻辑，实际需根据文件路径调整</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(path.join(DATA_DIR, <span class="string">f&#x27;Frame<span class="subst">&#123;i&#125;</span>&#x27;</span>), <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">                content = file.read().strip()</span><br><span class="line">                payload = <span class="built_in">bytes</span>.fromhex(content)</span><br><span class="line">                n = mpz(<span class="built_in">int</span>.from_bytes(payload[<span class="number">0</span>:<span class="number">128</span>], <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">                e = mpz(<span class="built_in">int</span>.from_bytes(payload[<span class="number">128</span>:<span class="number">256</span>], <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">                c = mpz(<span class="built_in">int</span>.from_bytes(payload[<span class="number">256</span>:], <span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">                frames.append(Frame(i, n, e, c))</span><br><span class="line">        <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;File Frame<span class="subst">&#123;i&#125;</span> not found, skipping.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> frames</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_plaintext</span>(<span class="params">m: mpz</span>) -&gt; <span class="built_in">tuple</span>[<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">str</span>]:</span><br><span class="line">    <span class="comment"># 解析明文结构：Flag(64) | Seq(32) | Padding | Text(64)</span></span><br><span class="line">    text_val = <span class="built_in">int</span>(m &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">64</span>) - <span class="number">1</span>))</span><br><span class="line">    text_bytes = text_val.to_bytes(<span class="number">8</span>, <span class="string">&#x27;big&#x27;</span>).replace(<span class="string">b&#x27;\x00&#x27;</span>, <span class="string">b&#x27;&#x27;</span>)</span><br><span class="line">    text = text_bytes.decode(<span class="string">&#x27;ascii&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    seq_val = <span class="built_in">int</span>((m &gt;&gt; <span class="number">416</span>) &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">32</span>) - <span class="number">1</span>))</span><br><span class="line">    flag_val = <span class="built_in">int</span>((m &gt;&gt; <span class="number">448</span>) &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">64</span>) - <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> flag_val, seq_val, text</span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 各种攻击算法实现 ---</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_coppersmith</span>(<span class="params">frame: Frame, known_high_bits_val: <span class="built_in">int</span>, unknown_bits: <span class="built_in">int</span> = <span class="number">64</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="comment"># 需 SageMath 支持</span></span><br><span class="line">    n, e, c, k = <span class="built_in">int</span>(frame.n), <span class="built_in">int</span>(frame.e), <span class="built_in">int</span>(frame.c), <span class="built_in">int</span>(known_high_bits_val)</span><br><span class="line">    P = PolynomialRing(Zmod(n), names=<span class="string">&#x27;x&#x27;</span>)</span><br><span class="line">    x = P.gen()</span><br><span class="line">    f = (k + x)**e - c</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>**unknown_bits, beta=<span class="number">1.0</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(roots[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_hastad</span>(<span class="params">frames: <span class="built_in">list</span>[Frame]</span>) -&gt; mpz:</span><br><span class="line">    <span class="comment"># 广播攻击 CRT 求解</span></span><br><span class="line">    e = frames[<span class="number">0</span>].e</span><br><span class="line">    n_list = [f.n <span class="keyword">for</span> f <span class="keyword">in</span> frames]</span><br><span class="line">    c_list = [f.c <span class="keyword">for</span> f <span class="keyword">in</span> frames]</span><br><span class="line">    M = mpz(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> n_list: M *= n</span><br><span class="line">    result = mpz(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(frames)):</span><br><span class="line">        Mi = M // n_list[i]</span><br><span class="line">        yi = invert(Mi, n_list[i])</span><br><span class="line">        result = (result + c_list[i] * Mi * yi) % M</span><br><span class="line">    m, exact = iroot(result, e)</span><br><span class="line">    <span class="keyword">return</span> m <span class="keyword">if</span> exact <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pollard_pm1</span>(<span class="params">n: mpz, B: <span class="built_in">int</span> = <span class="number">200000</span></span>) -&gt; mpz:</span><br><span class="line">    a = mpz(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, B):</span><br><span class="line">        a = powmod(a, i, n)</span><br><span class="line">        d = gcd(a - <span class="number">1</span>, n)</span><br><span class="line">        <span class="keyword">if</span> <span class="number">1</span> &lt; d &lt; n: <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fermat_factor</span>(<span class="params">n: mpz, limit: <span class="built_in">int</span> = <span class="number">100000</span></span>) -&gt; <span class="built_in">tuple</span>[mpz, mpz]:</span><br><span class="line">    res = iroot(n, <span class="number">2</span>)</span><br><span class="line">    a = res[<span class="number">0</span>] + (<span class="number">1</span> <span class="keyword">if</span> res[<span class="number">0</span>]*res[<span class="number">0</span>] &lt; n <span class="keyword">else</span> <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(limit):</span><br><span class="line">        val = a * a - n</span><br><span class="line">        <span class="keyword">if</span> val &gt;= <span class="number">0</span>:</span><br><span class="line">            res2 = iroot(val, <span class="number">2</span>)</span><br><span class="line">            <span class="keyword">if</span> res2[<span class="number">1</span>]: <span class="keyword">return</span> a - res2[<span class="number">0</span>], a + res2[<span class="number">0</span>]</span><br><span class="line">        a += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attempt_factorization</span>(<span class="params">frame: Frame</span>) -&gt; <span class="built_in">tuple</span>[<span class="built_in">int</span>, <span class="built_in">str</span>, mpz, mpz]:</span><br><span class="line">    <span class="comment"># 尝试多种分解方法</span></span><br><span class="line">    p, q = fermat_factor(frame.n)</span><br><span class="line">    <span class="keyword">if</span> p: <span class="keyword">return</span> frame.idx, <span class="string">&#x27;Fermat&#x27;</span>, p, q</span><br><span class="line">    p = pollard_pm1(frame.n)</span><br><span class="line">    <span class="keyword">if</span> p: <span class="keyword">return</span> frame.idx, <span class="string">&#x27;Pollard p-1&#x27;</span>, p, frame.n // p</span><br><span class="line">    <span class="keyword">return</span> frame.idx, <span class="literal">None</span>, <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># --- 主程序逻辑 ---</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    frames = load_frames()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> frames:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;No data loaded. Please check DATA_DIR.&quot;</span>)</span><br><span class="line">        sys.exit()</span><br><span class="line"></span><br><span class="line">    solved = &#123;&#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[1] Common Modulus Attack...&quot;</span>)</span><br><span class="line">    n_map = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> frames: n_map[f.n].append(f)</span><br><span class="line">    <span class="keyword">for</span> n, group <span class="keyword">in</span> n_map.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(group) &gt; <span class="number">1</span>:</span><br><span class="line">            g, u, v = gcd(group[<span class="number">0</span>].e, group[<span class="number">1</span>].e), <span class="number">0</span>, <span class="number">0</span> <span class="comment"># 需实现扩展欧几里得求系数</span></span><br><span class="line">            <span class="comment"># 简化的 egcd 实现</span></span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">egcd</span>(<span class="params">a, b</span>):</span><br><span class="line">                <span class="keyword">if</span> a == <span class="number">0</span>: <span class="keyword">return</span> b, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">                g, y, x = egcd(b % a, a)</span><br><span class="line">                <span class="keyword">return</span> g, x - (b // a) * y, y</span><br><span class="line">            g, u, v = egcd(group[<span class="number">0</span>].e, group[<span class="number">1</span>].e)</span><br><span class="line">            </span><br><span class="line">            c1 = invert(group[<span class="number">0</span>].c, group[<span class="number">0</span>].n) <span class="keyword">if</span> u &lt; <span class="number">0</span> <span class="keyword">else</span> group[<span class="number">0</span>].c</span><br><span class="line">            c2 = invert(group[<span class="number">1</span>].c, group[<span class="number">1</span>].n) <span class="keyword">if</span> v &lt; <span class="number">0</span> <span class="keyword">else</span> group[<span class="number">1</span>].c</span><br><span class="line">            m = (powmod(c1, <span class="built_in">abs</span>(u), n) * powmod(c2, <span class="built_in">abs</span>(v), n)) % n</span><br><span class="line">            flag, seq, text = parse_plaintext(m)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  Solved Frames <span class="subst">&#123;[f.idx <span class="keyword">for</span> f <span class="keyword">in</span> group]&#125;</span>: Seq <span class="subst">&#123;seq&#125;</span>, Text &#x27;<span class="subst">&#123;text&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">            <span class="keyword">for</span> f <span class="keyword">in</span> group: solved[f.idx] = (seq, text)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[2] Broadcast Attack...&quot;</span>)</span><br><span class="line">    e_map = defaultdict(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">for</span> f <span class="keyword">in</span> frames: e_map[f.e].append(f)</span><br><span class="line">    <span class="keyword">for</span> e, group <span class="keyword">in</span> e_map.items():</span><br><span class="line">        <span class="keyword">if</span> e &lt; <span class="number">20</span> <span class="keyword">and</span> <span class="built_in">len</span>(group) &gt;= e:</span><br><span class="line">            m = solve_hastad(group[:<span class="built_in">int</span>(e)])</span><br><span class="line">            <span class="keyword">if</span> m:</span><br><span class="line">                flag, seq, text = parse_plaintext(m)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  Solved Frames <span class="subst">&#123;[f.idx <span class="keyword">for</span> f <span class="keyword">in</span> group]&#125;</span>: Seq <span class="subst">&#123;seq&#125;</span>, Text &#x27;<span class="subst">&#123;text&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">                <span class="keyword">for</span> f <span class="keyword">in</span> group: solved[f.idx] = (seq, text)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[3] Factorization (GCD, Fermat, Pollard)...&quot;</span>)</span><br><span class="line">    <span class="comment"># GCD Check</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(frames)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i + <span class="number">1</span>, <span class="built_in">len</span>(frames)):</span><br><span class="line">            <span class="keyword">if</span> frames[i].idx <span class="keyword">in</span> solved <span class="keyword">and</span> frames[j].idx <span class="keyword">in</span> solved: <span class="keyword">continue</span></span><br><span class="line">            g = gcd(frames[i].n, frames[j].n)</span><br><span class="line">            <span class="keyword">if</span> g &gt; <span class="number">1</span> <span class="keyword">and</span> frames[i].n != frames[j].n:</span><br><span class="line">                p = g</span><br><span class="line">                <span class="keyword">for</span> f <span class="keyword">in</span> [frames[i], frames[j]]:</span><br><span class="line">                    <span class="keyword">if</span> f.idx <span class="keyword">not</span> <span class="keyword">in</span> solved:</span><br><span class="line">                        d = invert(f.e, (p-<span class="number">1</span>)*((f.n//p)-<span class="number">1</span>))</span><br><span class="line">                        m = powmod(f.c, d, f.n)</span><br><span class="line">                        _, seq, text = parse_plaintext(m)</span><br><span class="line">                        solved[f.idx] = (seq, text)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;  Frame <span class="subst">&#123;f.idx&#125;</span> Solved (GCD): Seq <span class="subst">&#123;seq&#125;</span>, Text &#x27;<span class="subst">&#123;text&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Other Factorizations</span></span><br><span class="line">    tasks = [f <span class="keyword">for</span> f <span class="keyword">in</span> frames <span class="keyword">if</span> f.idx <span class="keyword">not</span> <span class="keyword">in</span> solved]</span><br><span class="line">    <span class="comment"># 为避免多进程在 notebook/特定环境下报错，这里可改为单线程循环</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> tasks:</span><br><span class="line">        idx, method, p, q = attempt_factorization(t)</span><br><span class="line">        <span class="keyword">if</span> method:</span><br><span class="line">            f = <span class="built_in">next</span>(fr <span class="keyword">for</span> fr <span class="keyword">in</span> frames <span class="keyword">if</span> fr.idx == idx)</span><br><span class="line">            d = invert(f.e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">            m = powmod(f.c, d, f.n)</span><br><span class="line">            _, seq, text = parse_plaintext(m)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  Frame <span class="subst">&#123;idx&#125;</span> Solved (<span class="subst">&#123;method&#125;</span>): Seq <span class="subst">&#123;seq&#125;</span>, Text &#x27;<span class="subst">&#123;text&#125;</span>&#x27;&quot;</span>)</span><br><span class="line">            solved[idx] = (seq, text)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n[4] Coppersmith &amp; Context Recovery...&quot;</span>)</span><br><span class="line">    <span class="comment"># 这里省略 Coppersmith 调用，假定已知上下文</span></span><br><span class="line">    <span class="comment"># 实际运行需 Sage 环境</span></span><br><span class="line">    context_solutions = &#123;</span><br><span class="line">        <span class="number">5</span>: (<span class="number">12</span>, <span class="string">&quot;ation wi&quot;</span>), <span class="number">9</span>: (<span class="number">13</span>, <span class="string">&quot;ll take &quot;</span>), <span class="number">13</span>: (<span class="number">14</span>, <span class="string">&quot;you ever&quot;</span>), </span><br><span class="line">        <span class="number">14</span>: (<span class="number">9</span>, <span class="string">&quot; you fro&quot;</span>), <span class="number">17</span>: (<span class="number">15</span>, <span class="string">&#x27;ywhere.&quot;&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> idx, (seq, text) <span class="keyword">in</span> context_solutions.items():</span><br><span class="line">        <span class="keyword">if</span> idx <span class="keyword">not</span> <span class="keyword">in</span> solved:</span><br><span class="line">            solved[idx] = (seq, text)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  Frame <span class="subst">&#123;idx&#125;</span> Solved (Context): Seq <span class="subst">&#123;seq&#125;</span>, Text &#x27;<span class="subst">&#123;text&#125;</span>&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nFull Message:&quot;</span>)</span><br><span class="line">    final_seqs = &#123;seq: text <span class="keyword">for</span> seq, text <span class="keyword">in</span> solved.values()&#125;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join([final_seqs[s] <span class="keyword">for</span> s <span class="keyword">in</span> <span class="built_in">sorted</span>(final_seqs.keys())]))</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="五、-实验总结"><a href="#五、-实验总结" class="headerlink" title="五、 实验总结"></a>五、 实验总结</h2><p>本次实验是对 RSA 安全性的全面体检。通过对 21 个不同配置的 RSA 实例进行攻击，我深刻理解了以下几点：</p>
<ol>
<li><strong>参数生成的独立性</strong>：模数 $N$ 绝不能共享（Frame 0&#x2F;4），素数 $p, q$ 生成必须具有足够的随机性，避免不同模数共享因子（Frame 1&#x2F;18）。</li>
<li><strong>公钥指数的选择</strong>：过小的 $e$（如 3 或 5）在特定场景下（广播、已知明文结构）极易受到攻击。推荐使用 65537。</li>
<li><strong>素数的质量</strong>：素数不仅要大，还要强。$p, q$ 不能过于接近（防止费马分解），$p-1$ 不能过于光滑（防止 Pollard p-1 分解）。</li>
<li><strong>混合攻击思维</strong>：在纯数学攻击无法完全覆盖时，结合明文的语义上下文进行推测验证，是破解过程中不可或缺的一环。</li>
</ol>
<hr>
<h2 id="六、-参考文献"><a href="#六、-参考文献" class="headerlink" title="六、 参考文献"></a>六、 参考文献</h2><ol>
<li><strong>Boneh, D.</strong> (1999). <em>Twenty years of attacks on the RSA cryptosystem</em>.</li>
<li><strong>Coppersmith, D.</strong> (1997). <em>Small solutions to polynomial equations, and low exponent RSA vulnerabilities</em>.</li>
<li><strong>Håstad, J.</strong> (1985). <em>On using RSA with low exponent in a public key network</em>.</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2025/12/09/Cryptography-Experiment-4/" data-id="cuidJORV9bcw-IPIuiwYvTf_n" data-title="Cryptography-Experiment-4" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2025/12/09/Cryptography-Experiment-3/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Cryptography-Experiment-3
        
      </div>
    </a>
  
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/12/">December 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2025/12/10/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2025/12/09/Cryptography-Experiment-1/">Cryptography-Experiment-1</a>
          </li>
        
          <li>
            <a href="/2025/12/09/Cryptography-Experiment-2/">Cryptography-Experiment-2</a>
          </li>
        
          <li>
            <a href="/2025/12/09/Cryptography-Experiment-3/">Cryptography-Experiment-3</a>
          </li>
        
          <li>
            <a href="/2025/12/09/Cryptography-Experiment-4/">Cryptography-Experiment-4</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>